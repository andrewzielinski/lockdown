<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <link rel="stylesheet" href="stylesheets/screen.css" type="text/css" media="screen" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>
      Lockdown
  </title>
  <script src="javascripts/rounded_corners_lite.inc.js" type="text/javascript"></script>
<style>

</style>
  <script type="text/javascript">
    window.onload = function() {
      settings = {
          tl: { radius: 10 },
          tr: { radius: 10 },
          bl: { radius: 10 },
          br: { radius: 10 },
          antiAlias: true,
          autoPad: true,
          validTags: ["div"]
      }
      var versionBox = new curvyCorners(settings, document.getElementById("version"));
      versionBox.applyCornersToAll();
    }
  </script>
</head>
<body>
<div id="main">

    <h1>Lockdown</h1>
    <div id="version" class="clickable" onclick='document.location = "http://rubyforge.org/projects/lockdown"; return false'>
      <p>Get Version</p>
      <a href="http://rubyforge.org/projects/lockdown" class="numbers">0.4.6</a>
    </div>
    <h2>What</h2>


	<p>Lockdown is a authentication/authorization system for RubyOnRails (ver 2.x). While Merb functionality is in place, it is not complete.  There will be a release solely focused on getting the Merb functionality up to par with Rails.</p>


	<h2>Installing</h2>


	<p>For the people who don&#8217;t care to know the details and just want to get the system installed:</p>


<pre>
$ sudo gem install lockdown
$ cd &lt;your_project_directory&gt;
$ lockdown .
</pre>

	<p>This will create a &#8220;lockdown&#8221; directory in the lib dir add two files: init.rb and session.rb.  Modify init.rb to set defaults and define the rules that apply to your system.</p>


	<p><strong> Some noteworthy points:</strong>
<ul>
<li><strong>All Permissions are defined in init.rb, they cannot be defined via the administration screens.</strong></li>
<li><strong>All User Groups should be defined in init.rb. The administration screens can be used to create user groups, but doing so should be reserved for the unexpected.</strong></li>
<li><strong>Lockdown will sync up the rules (Permissions and User Groups) defined in init.rb with your database.</strong></li>
</ul></p>


	<p>To help you with your new application, Lockdown comes with a generator called lockdown_all.</p>


<pre>
$ cd &lt;your_project_directory&gt;
$ ./script/generate lockdown_all
</pre>

This will install resources such as:
<ul>
  <li>Models</li>
  <li>Controllers</li>
  <li>Views</li>
  <li>Helpers</li>
  <li>Migrations</li>
  <li>Routes</li>
</ul>

	<p>Please refer to the <a href="generator.html">generator page</a> for more detail.</p>


	<h2>How it works</h2>


Lockdown stores an array of access rights in the session.  For example, if you have a standard <span class="caps">REST</span> users controller, the access rights would be:
<pre>
  users/index
  users/show
  users/edit
  users/update
  users/new
  users/create
  users/destroy (delete for Merb)
</pre>

	<p>The above list will be stored in the session as an array and each request is tested against this list.</p>


	<p>To define access rights you need to modify lib/lockdown/init.rb.  This is the default init.rb included with Lockdown:
<pre class='syntax'>
<span class="ident">require</span> <span class="punct">&quot;</span><span class="string">lockdown</span><span class="punct">&quot;</span>
<span class="ident">require</span> <span class="constant">File</span><span class="punct">.</span><span class="ident">join</span><span class="punct">(</span><span class="constant">File</span><span class="punct">.</span><span class="ident">dirname</span><span class="punct">(</span><span class="constant">__FILE__</span><span class="punct">),</span> <span class="punct">&quot;</span><span class="string">session</span><span class="punct">&quot;)</span>

<span class="constant">Lockdown</span><span class="punct">::</span><span class="constant">System</span><span class="punct">.</span><span class="ident">configure</span> <span class="keyword">do</span>

  <span class="comment">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
  <span class="comment"># Configuration Options</span>
  <span class="comment">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
  <span class="comment"># Options with defaults:</span>
  <span class="comment">#</span>
  <span class="comment"># Set timeout to 1 hour:</span>
  <span class="comment">#       options[:session_timeout] = (60 * 60)</span>
  <span class="comment">#</span>
  <span class="comment"># Set system to logout if unauthorized access is attempted:</span>
  <span class="comment">#       options[:logout_on_access_violation] = false</span>
  <span class="comment">#</span>
  <span class="comment"># Set redirect to path on unauthorized access attempt:</span>
  <span class="comment">#       options[:access_denied_path] = &quot;/&quot;</span>
  <span class="comment">#</span>
  <span class="comment"># Set redirect to path on successful login:</span>
  <span class="comment">#       options[:successful_login_path] = &quot;/&quot;</span>
  <span class="comment">#</span>
  <span class="comment">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
  <span class="comment"># Define permissions</span>
  <span class="comment">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
  <span class="comment">#</span>
  <span class="comment"># set_permission(:product_management, all_methods(:products))</span>
  <span class="comment">#</span>
  <span class="comment"># :product_management is the name of the permission which is later</span>
  <span class="comment"># referenced by the set_user_group method</span>
  <span class="comment">#</span>
  <span class="comment"># :all_methods(:products) will return an array of all controller actions</span>
  <span class="comment"># for the products controller</span>
  <span class="comment">#</span>
  <span class="comment"># if products is your standard RESTful resource you'll get:</span>
  <span class="comment">#   [&quot;products/index , &quot;products/show&quot;,</span>
  <span class="comment">#    &quot;products/new&quot;, &quot;products/edit&quot;,</span>
  <span class="comment">#    &quot;products/create&quot;, &quot;products/update&quot;,</span>
  <span class="comment">#    &quot;products/destroy&quot;]</span>
  <span class="comment">#</span>
  <span class="comment"># You can pass multiple parameters to concat permissions such as:</span>
  <span class="comment">#      </span>
  <span class="comment">#	  set_permission(:security_management,all_methods(:users),</span>
  <span class="comment">#                                       all_methods(:user_groups),</span>
  <span class="comment">#                                       all_methods(:permissions) )</span>
  <span class="comment">#</span>
  <span class="comment"># In addition to all_methods(:controller) there are:</span>
  <span class="comment">#</span>
  <span class="comment">#       only_methods(:controller, :only_method_1, :only_method_2)</span>
  <span class="comment">#</span>
  <span class="comment">#       all_except_methods(:controller, :except_method_1, :except_method_2)</span>
  <span class="comment">#</span>
  <span class="comment"># Some other sample permissions:</span>
  <span class="comment"># </span>
  <span class="comment">#  set_permission(:sessions, all_methods(:sessions))</span>
  <span class="comment">#  set_permission(:my_account, only_methods(:users, :edit, :update, :show))</span>
  <span class="comment"># </span>
  <span class="comment"># Define your permissions here:</span>

  <span class="comment">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
  <span class="comment"># Built-in user groups</span>
  <span class="comment">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
  <span class="comment">#  You can assign the above permission to one of the built-in user groups</span>
  <span class="comment">#  by using the following:</span>
  <span class="comment"># </span>
  <span class="comment">#  To allow public access on the permissions :sessions and :home:</span>
  <span class="comment">#    set_public_access :sessions, :home</span>
  <span class="comment">#     </span>
  <span class="comment">#  Restrict :my_account access to only authenticated users:</span>
  <span class="comment">#    set_protected_access :my_account</span>
  <span class="comment">#</span>
  <span class="comment"># Define the built-in user groups here:</span>

  <span class="comment">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
  <span class="comment"># Define user groups</span>
  <span class="comment">#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span>
  <span class="comment">#</span>
  <span class="comment">#  set_user_group(:catalog_management, :category_management, </span>
  <span class="comment">#                                      :product_management) </span>
  <span class="comment">#</span>
  <span class="comment">#  :catalog_management is the name of the user group</span>
  <span class="comment">#  :category_management and :product_management refer to permission names</span>
  <span class="comment">#</span>
  <span class="comment"># </span>
  <span class="comment"># Define your user groups here:</span>

<span class="keyword">end</span> 
 
</pre></p>


	<h2>The internals</h2>


	<p>All configuration of Lockdown (Permissions and User Groups) are done in lib/lockdown/init.rb.  The database functionality is merely an extension of the definitions to allow for the dynamic creation of User Groups.  Permissions can not be created via the administration screens.</p>


	<p>Lockdown doesn&#8217;t have a concept of Roles. Instead, Lockdown users can be associated to one or many User Groups to allow for flexibility.  In addition, you can use the admin screens to add new User Groups to the database.</p>


	<p>Here are the parts to Lockdown:</p>


<div style="text-align:center">
<img src="model.jpg" alt="" />
</div>

<ul>
 <li><strong>Profiles</strong><br/>
    <p>The profile model contains all non-user information related to person.  Lockdown uses the profile record as the reference for updated_by and created_by.  This allows you to remove the user record completely when you want to revoke access, but you still retain the foreign key for history.<br/>Here are the fields you have to start with:</p>
    <ul>
      <li>first_name : string</li>
      <li>last_name : string</li>
      <li>email : string</li>
    </ul>
<br/>
  </li>
 <li><strong>Users</strong><br/>
    <p>The user model contains all user information related to person.<br/>Here are the fields you have to start with:</p>
    <ul>
      <li>login : string</li>
      <li>crypted_password : string</li>
      <li>salt : string</li>
      <li>profile_id : integer</li>
    </ul>
<br/>
  </li>
 <li><strong>User Groups</strong><br/>
    <p>User Groups exist only to group Permissions.  All functionality for your site should be covered by the user groups you define in init.rb.  You can use the admin screen to create new user groups if the need arises. The database model only has one field:  </p>
    <ul>
      <li>name : string</li>
    </ul>
<br/>
  </li>
 <li><strong>Permissions</strong><br/>
    <p>Permissions are the security building blocks of your system and are defined in init.rb.  A permission maps to controller(s)/action(s) in your system. Please refer back to the documenation in init.rb on how to create permissions.
 As permissions relate to system functionality, they cannot be created via the admin screen.  The database model only has one field:  </p>
    <ul>
      <li>name : string</li>
    </ul>
  </li>
</ul>

	<h2>Forum</h2>


	<p>If you are having a problem understanding how to use Lockdown, please post your question on the lockdown group.  If it&#8217;s documentation related, I will keep this page updated to help everyone.</p>


	<p><a href="http://groups.google.com/group/stonean_lockdown?hl=en">http://groups.google.com/group/stonean_lockdown?hl=en</a></p>


	<h2>How to submit patches</h2>


	<p>The Clone <span class="caps">URL</span>: git://github.com/stonean/lockdown.git</p>


	<p>Read the <a href="http://drnicwilliams.com/2007/06/01/8-steps-for-fixing-other-peoples-code/">8 steps for fixing other people&#8217;s code</a> and for section <a href="http://drnicwilliams.com/2007/06/01/8-steps-for-fixing-other-peoples-code/#8b-google-groups">8b: Submit patch to Google Groups</a>, use the Google Group above.</p>


	<p>I&#8217;m new to git and this whole opensource project admin gig, so please be patient with my stumbling around.</p>


	<h2>License</h2>


	<p>This code is free to use under the terms of the <span class="caps">MIT</span> license.</p>


	<h2>Contact</h2>


	<p>Comments and suggestions are welcome via the <a href="http://groups.google.com/group/stonean_lockdown?hl=en">forum</a></p>
    <p class="coda">
      8th May 2008<br/>
      Theme extended from <a href="http://rb2js.rubyforge.org/">Paul Battley</a>
    </p>
</div>
<script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
  var pageTracker = _gat._getTracker("UA-4189092-1");
  pageTracker._initData();
  pageTracker._trackPageview();
</script>
</body>
</html>
